%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Fundamental Current i^1_1 and fundamental volage u^1_2 for single-phase DC inverter
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}[h!]

    %   \documentclass{standalone}
    %   \usepackage{pgfplots}
    %   \pgfplotsset{compat=1.18} % Kompatibilität für neuere Versionen
           \centering
           \begin{tikzpicture}
                \pgfplotsset{set layers}
           \begin{axis}[
            % x/y range adjustment
            scale only axis,
            ymin=-400, ymax=400,
            xmin=0, xmax=360, 
            samples=500,
            axis y line=center,
            axis x line=bottom,
            extra y ticks=0,
            % Label text
            xlabel={$\omega t / \text{rad}$},
            ylabel={$u/\mathrm{V}$},
            % Label adjustment
            x label style={at={(axis description cs:1.05,0.5)},anchor=west},
            y label style={at={(axis description cs:0,.97)},anchor=south,yshift=0.2cm},
            width=0.6\textwidth,
            height=0.3\textwidth,
            % x-Ticks
            xtick={0, 30, 60, 90, 120, 150, 180, 210, 240, 270, 300,330, 360},
            xticklabels={0, $\frac{\pi}{6}$,$\frac{\pi}{3}$, $\frac{\pi}{2}$, $\frac{2\pi}{3}$, $\frac{5\pi}{6}$, $\pi$, $\frac{7\pi}{6}$, $\frac{4\pi}{3}$, $\frac{3\pi}{2}$, $\frac{5\pi}{3}$, $\frac{11\pi}{6}$, $2\pi$},
            xticklabel style = {anchor=north},
            % y-Ticks
            ytick={-400,-200,0,200,400},
            yticklabels={-400,-200,0,200,400},
            yticklabel style = {anchor=east},
            % Grid layout
           % grid,
            %grid style={line width=.1pt, draw=gray!10},
            %major grid style={line width=.2pt,draw=gray!90},
        ] 
        % Grid
        \draw[step=0.3cm, gray, thin] (0,-400) grid (360,400);
        % plot of u^(1)_2
        \addplot[signalalpha, domain= 0:360, solid, thick] {-150*sin(x)+200};
        \addplot[signalalpha, domain= 0:360, solid, thick] {-150*sin(x)-200};

        \begin{solutionblock}
         % Label of u^(\mathrm{h})_2
         \node[black, fill=white, inner sep = 1pt, anchor = south] at (axis cs:25,210) {$u^{(\mathrm{h})}_\mathrm{2}(t)$};
        % plot of u^(\mathrm{h})_2
        \addplot[black, thick, domain= 0:46, solid] {-150*sin(x)+200};
        \addplot[black,solid, thick] coordinates{(46,92.1) (46, -307.9)};
        \addplot[black, thick, domain= 46:60, solid] {-150*sin(x)-200};
        \addplot[black,solid, thick] coordinates{(60,-329.9) (60, 70.1)};
        \addplot[black, thick, domain= 60:110, solid] {-150*sin(x)+200};
        \addplot[black,solid, thick] coordinates{(110,59.05) (110, -340.95)};
        \addplot[black, thick, domain= 110:120, solid] {-150*sin(x)-200};
        \addplot[black,solid, thick] coordinates{(120,-329.9) (120, 70.1)};
        \addplot[black, thick, domain= 120:158, solid] {-150*sin(x)+200};
        \addplot[black,solid, thick] coordinates{(158,143.81) (158, -256.19)};
        \addplot[black, thick, domain= 158:180, solid] {-150*sin(x)-200};
        \addplot[black,solid, thick] coordinates{(180,-200) (180, 200)};
        \addplot[black, thick, domain= 180:202, solid] {-150*sin(x)+200}; 
        \addplot[black,solid, thick] coordinates{(202,256.19) (202, -143.81)};
        \addplot[black, thick, domain= 202:240, solid] {-150*sin(x)-200};
        \addplot[black,solid, thick] coordinates{(240,-70.1) (240, 329.9)};
        \addplot[black, thick, domain= 240:249, solid] {-150*sin(x)+200};
        \addplot[black,solid, thick] coordinates{(249,340.04) (249, -59.96)};
        \addplot[black, thick, domain= 249:300, solid] {-150*sin(x)-200};
        \addplot[black,solid, thick] coordinates{(300,-70.1) (300, 329.9)};
        \addplot[black, thick, domain= 300:315, solid] {-150*sin(x)+200};
        \addplot[black,solid, thick] coordinates{(315,306.68) (315, -93.32)};
        \addplot[black, thick, domain= 315:360, solid] {-150*sin(x)-200}; 
    \end{solutionblock}
      
           \end{axis}
           \begin{axis}[
            % x/y range adjustment
            scale only axis,
            ymin=-100, ymax=100,
            xmin=0, xmax=360,
            %axis x line=none, 
            samples=500,
            axis y line=right,
            axis x line=middle,
            extra y ticks=0,
            % Label text
            ylabel={$i/\mathrm{A}$},
            % Label adjustment
            xticklabel = \empty,
            y label style={rotate = -90,at={(axis description cs:1,.97)},anchor=south,yshift=0.2cm},
            width=0.6\textwidth,
            height=0.3\textwidth,
            % y-Ticks
            ytick={-100,-50,0,50,100},
            yticklabels={-100,-50,0,50,100},
            yticklabel style = {anchor=west},
            thick
            % Grid layout
           % grid,
            %grid style={line width=.1pt, draw=gray!10},
            %major grid style={line width=.2pt,draw=gray!90},
        ]
         % Start point
         \filldraw[black] (3,-44) circle (2pt) node[anchor=west]{\textbf{x}};
        \begin{solutionblock}
            % draw current harmonics i^(\mathrm{h})_2
            %\addplot[signaldelta, thick, domain= 0:46, solid] {80*sin(x)-50};
            \draw[thick, signaldelta, solid] (0,-44) -- (46,31.5) ;
            \draw[thick, signaldelta, solid] (46,31.5) -- (60,-11.67) -- (110,15.31) -- (120,-25.16) -- (158,26.1) -- (180,-25.16) ;
            \draw[thick, signaldelta, solid] (180,-25.16) -- (202, 28.8) -- (240, -19.76) -- (249, 23.41) -- (300, -6.27) -- (315, 36.92) -- (360, -33.226);
            % Label of i^(k)_2
            \node[signaldelta, fill=white, inner sep = 1pt, anchor = south] at (axis cs:280,30) {$i^{(\mathrm{h})}_\mathrm{2}(t)$};
            %\draw[thick, signaldelta, solid] (90,-22.05) ;
        \end{solutionblock}
           \end{axis}             
           \end{tikzpicture}
           \caption{Harmonics of the output voltage and current.}
           \label{sfig:ex07_sub1.3_Harmonics}
   \end{figure}